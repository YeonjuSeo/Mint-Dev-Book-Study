Chap 2 머신러닝 프로젝트 처음부터 끝까지
========
머신러닝 프로젝트를 진행할 때의 주요 단계
------
```
1. 큰 그림을 본다.  
2. 데이터를 구한다.  
3. 데이터로부터 통찰을 얻기 위해 탐색하고 시각화한다.  
4. 머신러닝 알고리즘을 위해 데이터를 준비한다.  
5. 모델을 선택하고 훈련시킨다.  
6. 모델을 상세하게 조정한다.  
7. 솔루션을 제시한다.  
8. 시스템을 론칭하고 모니터링하고 유지 보수한다.  
```
__지금부터 캘리포니아 인구조사 데이터를 사용해 캘리포니아의 주택 가격 모델을 만들 것이다. 위의 과정을 거쳐 해당 모델을 만들어보자.__  
__1. 큰 그림을 본다__   
1-1) 문제 정의: 비즈니스(프로젝트)의 목적에 따라 모델을 어떻게 만드느냐, 어떤 데이터를 사용하느냐 등이 달라지기 때문에 목적을 알고 문제를 올바르게 정의해야 한다. 또한 목적을 알았으면 해당 목적에 따라 어떤 학습을 시킬지(지도, 비지도, 강화학습), 어떤 작업에 해당되는지(분류, 회귀 등)를 생각해야 한다.  

1-2) 성능 측정 지표 선택: ex) 회귀문제에 해당한다면 RMSE(평균 제곱근 오차)나 MAE(평균 절대오차)를 성능 지표로 사용할 수 있다. RMSE, MAE 모두 예측 값의 벡터와 타깃 값의 벡터 사이의 거리를 재는 방법이다.  

1-3) 가정 검사: 지금까지 만든 가정을 나열하고 검사해본다.  


__2. 데이터 가져오기__  
2-1) 작업환경 만들기: 필요한 패키지 다운  

2-2) 데이터 다운로드: 여러 방법이 있지만 데이터를 다운로드하는 함수를 만들어 사용하면 편리하다.  

2-3) 데이터 구조 훑어보기: 받은 데이터의 특성을 파악한다. 각 데이터가 무엇을 나타내는지 확인한다.  

2-4) 테스트 세트 만들기: 일반적으로 데이터 셋의 20% 정도를 테스트 세트로 떼어놓는다.  


__3. 데이터 이해를 위한 탐색과 시각화__  
3-1) 지리적 데이터 시각화: 데이터에 지리 정보가 있으니 모든 구역을 산점도로 만들어 데이터를 시각화 한다- 매개변수를 다양하게 조절하여 두드러진 패턴을 추출한다.  

3-2) 상관관계 조사: 모든 특성 간의 표준 상관계수를 구한다. corr() 메서드를 이용해 계산하는 방법이 있고, 숫자형 특성 사이에 산점도를 그려주는 판다스의 scatter_matrix 함수를 사용하여 상관계수를 구할 수도 있다.  

3-3) 특성 조합으로 실험: 여러 특성을 조합하여 더 높은 상관계수를 갖는 특성을 만들어본다.  
 
 
__4. 머신러닝 알고리즘을 위한 데이터 준비__: 이 작업은 함수를 만들어 자동화하는 것이 좋다.  
4-1) 데이터 정제: 누락된 특성을 다루는 함수를 추가한다. (해당 구역을 제거, 전체 특성을 삭제, 어떤 값으로 채우는 등의 방법에 의해 해결될 수 있다.)또한 사이킷런의 SimpleImputer도 누락된 값을 손쉽게 다룰 수 있게 해준다.  

4-2) 텍스트와 범주형 특성 다루기: 수치형 특성만 다루었으니 텍스트와 범주형 특성도 다룬다. (OrdinalEncoder(sikit learn) : 텍스트에서 숫자로 변환)  

4-3) 나만의 변환기: 사이킷런이 유용한 변환기를 많이 제공하지만 특별한 정제 작업이나 어떤 특성들을 조합하는 등의 작업을 위해 자신만의 변환기를 만들어야 할 때가 있다. 또한 만든 이 변환기를 사이킷런의 기능과 매끄럽게 연동 해야한다.   

4-4) 특성 스케일링: 모든 특성의 범위를 같도록 만들어준다. min-max 스케일링(정규화)과 표준화를 널리 사용한다.  

4-5) 변환 파이프라인: 많은 변환 단계를 정확한 순서대로 실행할 수 있도록 한다.  


__5. 모델 선택과 훈련__  
5-1) 훈련 세트에서 훈련하고 평가하기  

5-2) 교차 검증을 사용한 평가  


__6. 모델 세부 튜닝__  
6-1) 그리드 탐색: 만족할 만한 하이퍼파라미터 조합을 찾을 때까지 수동으로 하이퍼파라미터를 조정하는 방법이 있지만 시간이 너무 오래 걸린다. 사이킷런의 GridSearchCV를 사용하는 것이 좋다. 이를 사용하면 탐색하고자 하는 하이퍼파라미터와 시도해볼 값을 지정하기만 하면 된다.   

6-2) 랜덤 탐색: 그리드 탐색 방법은 하이퍼파라미터 탐색 공간이 커지면 RandomizedSearchCV를 사용하는 편이 더 좋다.  

6-3) 앙상블 방법: 모델을 세밀하게 튜닝하는 또다른 방법은 최상의 모델을 연결해보는 것이다. (자세한 내용은 7장)   

6-4) 최상의 모델과 오차 분석: 최상의 모델을 분석하면 문제에 대한 좋은 통찰을 얻는 경우가 많다.  

6-5) 테스트 세트로 시스템 평가하기: 테스트 세트에서 최종 모델을 평가한다.  


__7. 론칭, 모니터링, 시스템 유지 보수__:   
제품 시스템에 적용하기 위한 준비를 한다. 배포를 하고 일정 간격으로 시스템의 실시간 성능을 체크파고 성능이 떨어졌을 때 알람을 통지할 수 있는 모니터링 코드를 작성해야 한다. 갑작스런 성능 감소 뿐만 아니라, 긴 시간동안 서서히 성능이 감소하는 것도 감지해야 한다.

